{"ast":null,"code":"// ag-grid-enterprise v21.2.1\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar ag_grid_community_1 = require(\"ag-grid-community\");\n\nvar numberFormats_1 = require(\"./numberFormats\");\n\nvar fonts_1 = require(\"./fonts\");\n\nvar fills_1 = require(\"./fills\");\n\nvar borders_1 = require(\"./borders\");\n\nvar cellStyleXfs_1 = require(\"./cellStyleXfs\");\n\nvar cellXfs_1 = require(\"./cellXfs\");\n\nvar cellStyles_1 = require(\"./cellStyles\");\n\nvar numberFormat_1 = require(\"./numberFormat\");\n\nvar font_1 = require(\"./font\");\n\nvar border_1 = require(\"./border\");\n\nvar stylesMap;\nvar registeredNumberFmts;\nvar registeredFonts;\nvar registeredFills;\nvar registeredBorders;\nvar registeredCellStyleXfs;\nvar registeredCellXfs;\nvar registeredCellStyles;\n\nvar resetStylesheetValues = function () {\n  stylesMap = {\n    base: 0\n  };\n  registeredNumberFmts = [];\n  registeredFonts = [{\n    name: 'Calibri',\n    size: 14,\n    colorTheme: '1',\n    family: 2,\n    scheme: 'minor'\n  }];\n  registeredFills = [{\n    patternType: 'none'\n  }, {\n    patternType: 'gray125'\n  }];\n  registeredBorders = [{\n    left: undefined,\n    right: undefined,\n    top: undefined,\n    bottom: undefined,\n    diagonal: undefined\n  }];\n  registeredCellStyleXfs = [{\n    borderId: 0,\n    fillId: 0,\n    fontId: 0,\n    numFmtId: 0\n  }];\n  registeredCellXfs = [{\n    borderId: 0,\n    fillId: 0,\n    fontId: 0,\n    numFmtId: 0,\n    xfId: 0\n  }];\n  registeredCellStyles = [{\n    builtinId: 0,\n    name: 'normal',\n    xfId: 0\n  }];\n};\n\nvar convertLegacyPattern = function (name) {\n  var colorMap = {\n    None: 'none',\n    Solid: 'solid',\n    Gray50: 'mediumGray',\n    Gray75: 'darkGray',\n    Gray25: 'lightGray',\n    HorzStripe: 'darkHorizontal',\n    VertStripe: 'darkVertical',\n    ReverseDiagStripe: 'darkDown',\n    DiagStripe: 'darkUp',\n    DiagCross: 'darkGrid',\n    ThickDiagCross: 'darkTrellis',\n    ThinHorzStripe: 'lightHorizontal',\n    ThinVertStripe: 'lightVertical',\n    ThinReverseDiagStripe: 'lightDown',\n    ThinDiagStripe: 'lightUp',\n    ThinHorzCross: 'lightGrid',\n    ThinDiagCross: 'lightTrellis',\n    Gray125: 'gray125',\n    Gray0625: 'gray0625'\n  };\n\n  if (!name) {\n    return 'none';\n  }\n\n  return colorMap[name] || name;\n};\n\nexports.convertLegacyColor = function (color) {\n  if (color == undefined) {\n    return color;\n  }\n\n  if (color.charAt(0) === '#') {\n    color = color.substr(1);\n  }\n\n  return color.length === 6 ? '00' + color : color;\n};\n\nvar registerFill = function (fill) {\n  var convertedPattern = convertLegacyPattern(fill.pattern);\n  var convertedFillColor = exports.convertLegacyColor(fill.color);\n  var convertedPatternColor = exports.convertLegacyColor(fill.patternColor);\n\n  var pos = ag_grid_community_1._.findIndex(registeredFills, function (currentFill) {\n    var patternType = currentFill.patternType,\n        fgRgb = currentFill.fgRgb,\n        bgRgb = currentFill.bgRgb;\n\n    if (patternType != convertedPattern || fgRgb != convertedFillColor || bgRgb != convertedPatternColor) {\n      return false;\n    }\n\n    return true;\n  });\n\n  if (pos === -1) {\n    pos = registeredFills.length;\n    registeredFills.push({\n      patternType: convertedPattern,\n      fgRgb: convertedFillColor,\n      bgRgb: convertedPatternColor\n    });\n  }\n\n  return pos;\n};\n\nvar registerNumberFmt = function (format) {\n  format = ag_grid_community_1._.utf8_encode(format);\n\n  if (numberFormat_1.numberFormatMap[format]) {\n    return numberFormat_1.numberFormatMap[format];\n  }\n\n  var pos = ag_grid_community_1._.findIndex(registeredNumberFmts, function (currentFormat) {\n    return currentFormat.formatCode === format;\n  });\n\n  if (pos === -1) {\n    pos = registeredNumberFmts.length + 164;\n    registeredNumberFmts.push({\n      formatCode: format,\n      numFmtId: pos\n    });\n  } else {\n    pos = registeredNumberFmts[pos].numFmtId;\n  }\n\n  return pos;\n};\n\nvar registerBorders = function (borders) {\n  var borderBottom = borders.borderBottom,\n      borderTop = borders.borderTop,\n      borderLeft = borders.borderLeft,\n      borderRight = borders.borderRight;\n  var bottomStyle, topStyle, leftStyle, rightStyle;\n  var bottomColor, topColor, leftColor, rightColor;\n\n  if (borderLeft) {\n    leftStyle = border_1.convertLegacyBorder(borderLeft.lineStyle, borderLeft.weight);\n    leftColor = exports.convertLegacyColor(borderLeft.color);\n  }\n\n  if (borderRight) {\n    rightStyle = border_1.convertLegacyBorder(borderRight.lineStyle, borderRight.weight);\n    rightColor = exports.convertLegacyColor(borderRight.color);\n  }\n\n  if (borderBottom) {\n    bottomStyle = border_1.convertLegacyBorder(borderBottom.lineStyle, borderBottom.weight);\n    bottomColor = exports.convertLegacyColor(borderBottom.color);\n  }\n\n  if (borderTop) {\n    topStyle = border_1.convertLegacyBorder(borderTop.lineStyle, borderTop.weight);\n    topColor = exports.convertLegacyColor(borderTop.color);\n  }\n\n  var pos = ag_grid_community_1._.findIndex(registeredBorders, function (currentBorder) {\n    var left = currentBorder.left,\n        right = currentBorder.right,\n        top = currentBorder.top,\n        bottom = currentBorder.bottom;\n\n    if (!left && (leftStyle || leftColor)) {\n      return false;\n    }\n\n    if (!right && (rightStyle || rightColor)) {\n      return false;\n    }\n\n    if (!top && (topStyle || topColor)) {\n      return false;\n    }\n\n    if (!bottom && (bottomStyle || bottomColor)) {\n      return false;\n    }\n\n    var _a = left || {},\n        clS = _a.style,\n        clC = _a.color;\n\n    var _b = right || {},\n        crS = _b.style,\n        crC = _b.color;\n\n    var _c = top || {},\n        ctS = _c.style,\n        ctC = _c.color;\n\n    var _d = bottom || {},\n        cbS = _d.style,\n        cbC = _d.color;\n\n    if (clS != leftStyle || clC != leftColor) {\n      return false;\n    }\n\n    if (crS != rightStyle || crC != rightColor) {\n      return false;\n    }\n\n    if (ctS != topStyle || ctC != topColor) {\n      return false;\n    }\n\n    if (cbS != bottomStyle || cbC != bottomColor) {\n      return false;\n    }\n\n    return true;\n  });\n\n  if (pos === -1) {\n    pos = registeredBorders.length;\n    registeredBorders.push({\n      left: {\n        style: leftStyle,\n        color: leftColor\n      },\n      right: {\n        style: rightStyle,\n        color: rightColor\n      },\n      top: {\n        style: topStyle,\n        color: topColor\n      },\n      bottom: {\n        style: bottomStyle,\n        color: bottomColor\n      },\n      diagonal: {\n        style: undefined,\n        color: undefined\n      }\n    });\n  }\n\n  return pos;\n};\n\nvar registerFont = function (font) {\n  var name = font.fontName,\n      color = font.color,\n      size = font.size,\n      bold = font.bold,\n      italic = font.italic,\n      outline = font.outline,\n      shadow = font.shadow,\n      strikeThrough = font.strikeThrough,\n      underline = font.underline,\n      family = font.family;\n  var utf8Name = name ? ag_grid_community_1._.utf8_encode(name) : name;\n  var convertedColor = exports.convertLegacyColor(color);\n  var familyId = font_1.getFamilyId(family);\n\n  var pos = ag_grid_community_1._.findIndex(registeredFonts, function (currentFont) {\n    if (currentFont.name != utf8Name || currentFont.color != convertedColor || currentFont.size != size || currentFont.bold != bold || currentFont.italic != italic || currentFont.outline != outline || currentFont.shadow != shadow || currentFont.strike != strikeThrough || currentFont.underline != underline || currentFont.family != familyId) {\n      return false;\n    }\n\n    return true;\n  });\n\n  if (pos === -1) {\n    pos = registeredFonts.length;\n    registeredFonts.push({\n      name: utf8Name,\n      color: convertedColor,\n      size: size,\n      bold: bold,\n      italic: italic,\n      outline: outline,\n      shadow: shadow,\n      strike: strikeThrough,\n      underline: underline,\n      family: familyId\n    });\n  }\n\n  return pos;\n};\n\nvar registerStyle = function (config) {\n  var id = config.id,\n      alignment = config.alignment,\n      borders = config.borders,\n      font = config.font,\n      interior = config.interior,\n      numberFormat = config.numberFormat,\n      protection = config.protection;\n  var currentFill = 0;\n  var currentBorder = 0;\n  var currentFont = 0;\n  var currentNumberFmt = 0;\n\n  if (!id || stylesMap[id] != undefined) {\n    return;\n  }\n\n  if (interior) {\n    currentFill = registerFill(interior);\n  }\n\n  if (borders) {\n    currentBorder = registerBorders(borders);\n  }\n\n  if (font) {\n    currentFont = registerFont(font);\n  }\n\n  if (numberFormat) {\n    currentNumberFmt = registerNumberFmt(numberFormat.format);\n  }\n\n  stylesMap[id] = registeredCellXfs.length;\n  registeredCellXfs.push({\n    alignment: alignment,\n    borderId: currentBorder || 0,\n    fillId: currentFill || 0,\n    fontId: currentFont || 0,\n    numFmtId: currentNumberFmt || 0,\n    protection: protection,\n    xfId: 0\n  });\n};\n\nvar stylesheetFactory = {\n  getTemplate: function () {\n    var numberFormats = numberFormats_1.default.getTemplate(registeredNumberFmts);\n    var fonts = fonts_1.default.getTemplate(registeredFonts);\n    var fills = fills_1.default.getTemplate(registeredFills);\n    var borders = borders_1.default.getTemplate(registeredBorders);\n    var cellStylesXfs = cellStyleXfs_1.default.getTemplate(registeredCellStyleXfs);\n    var cellXfs = cellXfs_1.default.getTemplate(registeredCellXfs);\n    var cellStyles = cellStyles_1.default.getTemplate(registeredCellStyles);\n    resetStylesheetValues();\n    return {\n      name: 'styleSheet',\n      properties: {\n        rawMap: {\n          xmlns: 'http://schemas.openxmlformats.org/spreadsheetml/2006/main'\n        }\n      },\n      children: [numberFormats, fonts, fills, borders, cellStylesXfs, cellXfs, cellStyles, {\n        name: 'tableStyles',\n        properties: {\n          rawMap: {\n            count: 0,\n            defaultPivotStyle: 'PivotStyleLight16',\n            defaultTableStyle: 'TableStyleMedium2'\n          }\n        }\n      }]\n    };\n  }\n};\n\nexports.getStyleId = function (name) {\n  return stylesMap[name] || 0;\n};\n\nexports.registerStyles = function (styles) {\n  resetStylesheetValues();\n  styles.forEach(registerStyle);\n};\n\nexports.default = stylesheetFactory;","map":null,"metadata":{},"sourceType":"script"}